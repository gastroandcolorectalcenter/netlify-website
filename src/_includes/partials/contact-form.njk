{# 
  Contact Form Component
  Uses Formspree for form handling
  
  Optional variables:
  - formType: "contact" or "appointment" (default: contact)
  - formTitle: Custom form title
#}

{% set formId = site.formspree.contactFormId if formType == "contact" else site.formspree.appointmentFormId %}
{% set defaultTitle = "Get in Touch" if formType == "contact" else "Book Your Appointment" %}

<div class="contact-form-container">
  {% if formTitle or defaultTitle %}
  <h2 class="form-title">{{ formTitle or defaultTitle }}</h2>
  {% endif %}
  
  <form action="https://formspree.io/f/{{ formId }}" 
        method="POST" 
        class="contact-form"
        id="{{ formType or 'contact' }}-form">
    
    {# Hidden Fields #}
    <input type="hidden" name="_subject" value="New {{ formType or 'Contact' }} Form Submission">
    <input type="hidden" name="_next" value="{{ site.url }}/thank-you/">
    <input type="hidden" name="_captcha" value="false">
    
    {# Name Field #}
    <div class="form-group">
      <label for="name" class="form-label">
        Full Name <span class="required">*</span>
      </label>
      <input type="text" 
             id="name" 
             name="name" 
             class="form-input"
             required
             placeholder="Enter your full name">
    </div>
    
    {# Email Field #}
    <div class="form-group">
      <label for="email" class="form-label">
        Email Address <span class="required">*</span>
      </label>
      <input type="email" 
             id="email" 
             name="email" 
             class="form-input"
             required
             placeholder="your.email@example.com">
    </div>
    
    {# Phone Field #}
    <div class="form-group">
      <label for="phone" class="form-label">
        Phone Number <span class="required">*</span>
      </label>
      <input type="tel" 
             id="phone" 
             name="phone" 
             class="form-input"
             required
             placeholder="+977 XXX XXX XXXX">
    </div>
    
    {% if formType == "appointment" %}
    {# Appointment-specific fields #}
    
    {# Preferred Date #}
    <div class="form-group">
      <label for="preferred-date" class="form-label">
        Preferred Date <span class="required">*</span>
      </label>
      <input type="date" 
             id="preferred-date" 
             name="preferred_date" 
             class="form-input"
             required
             min="{{ "now" | htmlDateString }}">
    </div>
    
    {# Preferred Time #}
    <div class="form-group">
      <label for="preferred-time" class="form-label">
        Preferred Time
      </label>
      <select id="preferred-time" name="preferred_time" class="form-input">
        <option value="">Select a time</option>
        <option value="morning">Morning (9:00 AM - 12:00 PM)</option>
        <option value="afternoon">Afternoon (12:00 PM - 3:00 PM)</option>
        <option value="evening">Evening (3:00 PM - 6:00 PM)</option>
      </select>
    </div>
    
    {# Hospital Preference #}
    <div class="form-group">
      <label for="hospital" class="form-label">
        Preferred Hospital
      </label>
      <select id="hospital" name="hospital" class="form-input">
        <option value="">Select a hospital</option>
        {% for hospital in hospitals.hospitals %}
        <option value="{{ hospital.name }}">{{ hospital.name }} - {{ hospital.location }}</option>
        {% endfor %}
      </select>
    </div>
    
    {# Reason for Visit #}
    <div class="form-group">
      <label for="reason" class="form-label">
        Reason for Visit
      </label>
      <select id="reason" name="reason" class="form-input">
        <option value="">Select a reason</option>
        <option value="consultation">General Consultation</option>
        <option value="surgery">Surgical Consultation</option>
        <option value="followup">Follow-up Visit</option>
        <option value="emergency">Emergency</option>
        <option value="other">Other</option>
      </select>
    </div>
    {% endif %}
    
    {# Message Field #}
    <div class="form-group">
      <label for="message" class="form-label">
        {% if formType == "appointment" %}Additional Information{% else %}Message{% endif %}
        <span class="required">*</span>
      </label>
      <textarea id="message" 
                name="message" 
                class="form-input form-textarea"
                rows="5"
                required
                placeholder="{% if formType == 'appointment' %}Please provide any additional details about your condition or concerns...{% else %}How can we help you?{% endif %}"></textarea>
    </div>
    
    {# Submit Button #}
    <div class="form-group">
      <button type="submit" class="btn btn-primary btn-full">
        {% include "svg/send.njk" %}
        <span>{% if formType == "appointment" %}Book Appointment{% else %}Send Message{% endif %}</span>
      </button>
    </div>
    
    {# Privacy Notice #}
    <p class="form-privacy">
      By submitting this form, you agree to our 
      <a href="/privacy/">Privacy Policy</a> and consent to being contacted regarding your inquiry.
    </p>
  </form>
  
  {# Success Message (Hidden by default, shown by JavaScript) #}
  <div class="form-success" hidden>
    <div class="success-icon">
      {% include "svg/check-circle.njk" %}
    </div>
    <h3>Thank You!</h3>
    <p>We've received your {% if formType == "appointment" %}appointment request{% else %}message{% endif %}. We'll get back to you within 24 hours.</p>
  </div>
</div>