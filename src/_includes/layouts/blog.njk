---
layout: layouts/base.njk
---

<article class="blog-post">
  {# Blog Post Header #}
  <header class="blog-post-header">
    <div class="container">
      {# Language Toggle Button #}
      <div class="language-toggle">
        <button class="lang-btn active" data-lang="en" aria-label="Switch to English">
          <span class="lang-icon">ðŸ‡¬ðŸ‡§</span>
          <span class="lang-text">English</span>
        </button>
        <button class="lang-btn" data-lang="ne" aria-label="Switch to Nepali">
          <span class="lang-icon">ðŸ‡³ðŸ‡µ</span>
          <span class="lang-text">à¤¨à¥‡à¤ªà¤¾à¤²à¥€</span>
        </button>
      </div>
      
      {# Post Title #}
      <h1 class="blog-post-title" data-lang-en="{{ title }}" data-lang-ne="{{ titleNe or title }}">{{ title }}</h1>
      
      {# Post Meta Information #}
      <div class="blog-post-meta">
        <time datetime="{{ date | htmlDateString }}" class="post-date">
          {% include "svg/calendar.njk" %}
          <span>{{ date | readableDate }}</span>
        </time>
        
        {% if author %}
        <span class="post-author">
          {% include "svg/user.njk" %}
          <span>{{ author }}</span>
        </span>
        {% endif %}
        
        {% if category %}
        <span class="post-category">
          {% include "svg/folder.njk" %}
          <span>
            {% if category is iterable and category is not string %}
              {{ category | join(', ') }}
            {% else %}
              {{ category }}
            {% endif %}
          </span>
        </span>
        {% endif %}
        
        {% if readingTime %}
        <span class="post-reading-time">
          {% include "svg/clock.njk" %}
          <span>{{ readingTime }} min read</span>
        </span>
        {% endif %}
      </div>
      
      {# Featured Image with WebP fallback #}
      {% if featuredImage %}
      <div class="blog-post-image">
        <picture>
          <source srcset="{{ featuredImage | replace('.jpg', '.webp') | replace('.jpeg', '.webp') | replace('.png', '.webp') }}" type="image/webp">
          <source srcset="{{ featuredImage }}" type="image/jpeg">
          <img src="{{ featuredImage }}" 
               alt="{{ featuredImageAlt or title }}" 
               loading="eager"
               width="1200"
               height="630">
        </picture>
      </div>
      {% endif %}
      
      {# Excerpt/Summary #}
      {% if excerpt %}
      <div class="blog-post-excerpt" data-lang-en="{{ excerpt }}" data-lang-ne="{{ excerptNe or excerpt }}">
        <p>{{ excerpt }}</p>
      </div>
      {% endif %}
    </div>
  </header>
  
  {# Blog Post Content with Sidebar #}
  <div class="container">
    <div class="blog-layout">
      {# Main Content Area #}
      <div class="blog-main-content">
        {# Content (includes both English and Nepali in markdown) #}
        <div class="blog-post-content">
          {{ content | addWebpToImages | safe }}
        </div>
        
        {# Tags #}
        {% if tags %}
        <footer class="blog-post-footer">
          <div class="post-tags">
            <strong>Tags:</strong>
            {% for tag in tags %}
              {% if tag != "blogs" %}
              <a href="/blogs/?category={{ tag | slugify }}" class="tag">{{ tag }}</a>
              {% endif %}
            {% endfor %}
          </div>
        </footer>
        {% endif %}
        
        {# Share Buttons #}
        <div class="blog-share">
          <h3>Share this article</h3>
          <div class="share-buttons">
            <a href="https://www.facebook.com/sharer/sharer.php?u={{ site.url }}{{ page.url }}" 
               target="_blank" 
               rel="noopener noreferrer" 
               class="share-btn facebook"
               aria-label="Share on Facebook">
              {% include "svg/facebook.njk" %}
              <span>Facebook</span>
            </a>
            <a href="https://twitter.com/intent/tweet?url={{ site.url }}{{ page.url }}&text={{ title }}" 
               target="_blank" 
               rel="noopener noreferrer" 
               class="share-btn twitter"
               aria-label="Share on Twitter">
              {% include "svg/twitter.njk" %}
              <span>Twitter</span>
            </a>
            <a href="https://www.linkedin.com/shareArticle?mini=true&url={{ site.url }}{{ page.url }}&title={{ title }}" 
               target="_blank" 
               rel="noopener noreferrer" 
               class="share-btn linkedin"
               aria-label="Share on LinkedIn">
              {% include "svg/linkedin.njk" %}
              <span>LinkedIn</span>
            </a>
            <a href="https://api.whatsapp.com/send?text={{ title }}%20{{ site.url }}{{ page.url }}" 
               target="_blank" 
               rel="noopener noreferrer" 
               class="share-btn whatsapp"
               aria-label="Share on WhatsApp">
              {% include "svg/whatsapp.njk" %}
              <span>WhatsApp</span>
            </a>
          </div>
        </div>
        
        {# Author Bio #}
        <div class="author-bio">
          <div class="author-bio-content">
            {% if doctor.image %}
            <img src="{{ doctor.image }}" alt="{{ doctor.name }}" class="author-avatar">
            {% endif %}
            <div class="author-info">
              <h3>About {{ doctor.name }}</h3>
              <p class="author-credentials">{{ doctor.title }} | {{ doctor.specialization }}</p>
              <p>{{ doctor.bio.short }}</p>
              <a href="/about/" class="btn-link">Read full bio â†’</a>
            </div>
          </div>
        </div>
      </div>
      
      {# Sidebar #}
      <aside class="blog-sidebar">
        {# Related Articles #}
        <div class="sidebar-widget related-articles-widget">
          <h3 class="widget-title">Related Articles</h3>
          <div class="related-articles-list">
            {% set relatedCount = 0 %}
            {% set currentCategoryNormalized = category | slugify %}
            
            {# Show only posts from the same category #}
            {% for post in collections.blogs %}
              {% if relatedCount < 5 and post.url != page.url %}
                {% set postCategoryNormalized = post.data.category | slugify %}
                
                {# Check if normalized categories match #}
                {% if postCategoryNormalized == currentCategoryNormalized %}
                  {% set relatedCount = relatedCount + 1 %}
                  <article class="related-article-item">
                    {% if post.data.featuredImage %}
                    <div class="related-article-image">
                      <a href="{{ post.url }}">
                        <picture>
                          <source srcset="{{ post.data.featuredImage | replace('.jpg', '.webp') | replace('.jpeg', '.webp') | replace('.png', '.webp') }}" type="image/webp">
                          <source srcset="{{ post.data.featuredImage }}" type="image/jpeg">
                          <img src="{{ post.data.featuredImage }}" 
                               alt="{{ post.data.title }}" 
                               loading="lazy"
                               width="200"
                               height="200">
                        </picture>
                      </a>
                    </div>
                    {% endif %}
                    <div class="related-article-content">
                      <h4 class="related-article-title">
                        <a href="{{ post.url }}">{{ post.data.title }}</a>
                      </h4>
                      <div class="related-article-meta">
                        <time datetime="{{ post.date | htmlDateString }}">
                          {{ post.date | readableDate }}
                        </time>
                        {% if post.data.readingTime %}
                        <span class="reading-time">{{ post.data.readingTime }} min</span>
                        {% endif %}
                      </div>
                    </div>
                  </article>
                {% endif %}
              {% endif %}
            {% endfor %}
            
            {% if relatedCount == 0 %}
              <p class="no-related">No related articles in this category yet. <a href="/blogs/">Browse all articles</a></p>
            {% endif %}
          </div>
        </div>

        {# Categories Widget #}
        <div class="sidebar-widget categories-widget">
          <h3 class="widget-title">Browse by Category</h3>
          <ul class="categories-list">
            {% set allCategories = collections.blogs | getAllCategories %}
            {% for cat in allCategories %}
            <li class="category-item{% if cat == category %} expanded{% endif %}">
              <button class="category-link{% if cat == category %} active{% endif %}" 
                      data-category="{{ cat | slugify }}" 
                      type="button"
                      aria-expanded="{% if cat == category %}true{% else %}false{% endif %}"
                      aria-controls="category-posts-{{ cat | slugify }}">
                <span class="category-name">{{ cat }}</span>
                <span class="post-count">
                  ({{ collections.blogs | filterByCategory(cat) | length }})
                </span>
                <span class="category-toggle-icon">â–¼</span>
              </button>
              
              {# Expandable list of posts in this category #}
              <ul class="category-posts-list{% if cat == category %} expanded{% endif %}" 
                  id="category-posts-{{ cat | slugify }}"
                  data-category-posts="{{ cat | slugify }}">
                {% set categoryPosts = collections.blogs | filterByCategory(cat) %}
                {% for post in categoryPosts %}
                <li class="category-post-item">
                  <a href="{{ post.url }}" class="category-post-link{% if post.url == page.url %} current-post{% endif %}">
                    {{ post.data.title }}
                  </a>
                </li>
                {% endfor %}
              </ul>
            </li>
            {% endfor %}
          </ul>
        </div>
        
        {# Affiliated Hospitals #}
        <div class="sidebar-widget hospitals-widget">
          <h3 class="widget-title">Affiliated Hospitals</h3>
          <div class="sidebar-hospitals-list">
            {% for hospital in hospitals.hospitals %}
            <div class="sidebar-hospital-item">
              <h4 class="hospital-name">{{ hospital.name }}</h4>
              <p class="hospital-location">
                {% include "svg/location.njk" %}
                <span>{{ hospital.location }}</span>
              </p>
              {% if hospital.phone %}
              <a href="tel:{{ hospital.phone }}" class="hospital-contact">
                {% include "svg/phone.njk" %}
                <span>Call Now</span>
              </a>
              {% endif %}
            </div>
            {% endfor %}
          </div>
        </div>
        
        {# CTA Buttons #}
        <div class="sidebar-widget cta-widget">
          <h3 class="widget-title">Book Your Appointment</h3>
          <p class="cta-text">Schedule a consultation with Dr. Shah today.</p>
          {% include "partials/cta-buttons.njk" %}
        </div>
      </aside>
    </div>
    
    {# CTA Section - Mobile #}
    <section class="blog-cta mobile-only">
      <h2>Need Medical Advice?</h2>
      <p>Schedule a consultation with Dr. Shah for personalized medical care.</p>
      {% include "partials/cta-buttons.njk" %}
    </section>
  </div>
  
  {# Medical Disclaimer Popup #}
  <div class="disclaimer-overlay" id="disclaimerPopup">
    <div class="disclaimer-popup">
      <div class="disclaimer-header">
        <svg class="disclaimer-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
        </svg>
        <h3>Medical Disclaimer</h3>
      </div>
      
      <div class="disclaimer-content">
        <p><strong>Important Notice:</strong> The information provided in this blog post is for educational and informational purposes only.</p>
        
        <ul>
          <li>This content is <strong>not a substitute</strong> for professional medical advice, diagnosis, or treatment.</li>
          <li>Always seek the advice of your physician or qualified healthcare provider with any questions about a medical condition.</li>
          <li>Never disregard professional medical advice or delay seeking it because of something you have read on this website.</li>
          <li>If you think you may have a medical emergency, call your doctor or emergency services immediately.</li>
        </ul>
        
        <p class="disclaimer-note">By continuing to read this article, you acknowledge that you have read and understood this disclaimer.</p>
      </div>
      
      <div class="disclaimer-actions">
        <button class="btn-disclaimer btn-accept" id="acceptDisclaimer">
          I Understand
        </button>
        <button class="btn-disclaimer btn-decline" id="declineDisclaimer">
          Go Back
        </button>
      </div>
    </div>
  </div>
</article>

{# Structured Data for Blog Post #}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "{{ title }}",
  "description": "{{ excerpt or description }}",
  "author": {
    "@type": "Person",
    "name": "{{ author or doctor.name }}"
  },
  "datePublished": "{{ date | htmlDateString }}",
  "dateModified": "{{ modified or date | htmlDateString }}",
  "image": "{{ site.url }}{{ featuredImage or site.seo.ogImage }}",
  "publisher": {
    "@type": "Organization",
    "name": "{{ site.name }}",
    "logo": {
      "@type": "ImageObject",
      "url": "{{ site.url }}/assets/images/logo.png"
    }
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "{{ site.url }}{{ page.url }}"
  }
}
</script>
